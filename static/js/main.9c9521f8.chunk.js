(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{22:function(e,t,a){e.exports=a(61)},27:function(e,t,a){},59:function(e,t,a){},61:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),o=a(15),r=a.n(o),c=(a(27),a(4)),l=a(5),i=a(7),d=a(6),m=a(8),u=a(1),h=a(2);a(12),a(13);function g(e,t,a){var n=new FileReader;n.readAsArrayBuffer(e),n.onload=function(){var e=function(e){var t=new DataView(e);if(65496!=t.getUint16(0,!1))return-2;var a=t.byteLength,n=2;for(;n<a;){var s=t.getUint16(n,!1);if(n+=2,65505==s){if(1165519206!=t.getUint32(n+=2,!1))return-1;var o=18761==t.getUint16(n+=6,!1);n+=t.getUint32(n+4,o);var r=t.getUint16(n,o);n+=2;for(var c=0;c<r;c++)if(274==t.getUint16(n+12*c,o))return t.getUint16(n+12*c+8,o)}else{if(65280!=(65280&s))break;n+=t.getUint16(n,!1)}}return-1}(n.result),a="data:image/jpg;base64,"+function(e){for(var t,a="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=new Uint8Array(e),o=s.byteLength,r=o%3,c=o-r,l=0;l<c;l+=3)t=s[l]<<16|s[l+1]<<8|s[l+2],a+=n[(16515072&t)>>18]+n[(258048&t)>>12]+n[(4032&t)>>6]+n[63&t];1==r?(t=s[c],a+=n[(252&t)>>2]+n[(3&t)<<4]+"=="):2==r&&(t=s[c]<<8|s[c+1],a+=n[(64512&t)>>10]+n[(1008&t)>>4]+n[(15&t)<<2]+"=");return a}(n.result),s=new Image;s.setAttribute("src",a),s.onload=function(){var a=Math.floor(s.height*(800/s.width)),n=document.createElement("canvas");n.width=800,n.height=a;var o=n.getContext("2d");switch([5,6,7,8].indexOf(e)>-1?(n.width=a,n.height=800):(n.width=800,n.height=a),e){case 2:o.transform(-1,0,0,1,800,0);break;case 3:o.transform(-1,0,0,-1,800,a);break;case 4:o.transform(1,0,0,-1,0,a);break;case 5:o.transform(0,1,1,0,0,0);break;case 6:o.transform(0,1,-1,0,a,0);break;case 7:o.transform(0,-1,-1,0,a,800);break;case 8:o.transform(0,-1,1,0,0,800);break;default:o.transform(1,0,0,1,0,0)}o.drawImage(s,0,0,800,a),t(n.toDataURL("image/jpeg",.7))}},n.onerror=a}var p=a(9),f=a.n(p);var b=function(e){return e&&e.startsWith("zh")?"cht":"eng"},y=(a(59),"\u9ed8\u66f8\u6613 Dict-Ez\uff1a\u5148\u9078\u64c7\u8a9e\u8a00"),v=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(i.a)(this,Object(d.a)(t).call(this,e))).state={toolbar_msg:y,lang:P,isPostingOcr:!1,scannedFileBase64:""},a.handleReset=a.handleReset.bind(Object(u.a)(Object(u.a)(a))),a.handleCapturing=a.handleCapturing.bind(Object(u.a)(Object(u.a)(a))),a.processBase64Image=a.processBase64Image.bind(Object(u.a)(Object(u.a)(a))),a.processBase64ImageError=a.processBase64ImageError.bind(Object(u.a)(Object(u.a)(a))),a.processOcrContent=a.processOcrContent.bind(Object(u.a)(Object(u.a)(a))),a.processOcrError=a.processOcrError.bind(Object(u.a)(Object(u.a)(a))),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"resetAll",value:function(){this.setState({toolbar_msg:y,lang:P,isPostingOcr:!1,scannedFileBase64:""})}},{key:"processBase64Image",value:function(e){this.setState({scannedFileBase64:e}),this.setState({toolbar_msg:"\u9ed8\u66f8\u6613 Dict-Ez\uff1a\u6309\u4e0b\u5716\u8c61\u8fa8\u6790"})}},{key:"processBase64ImageError",value:function(e){console.log(e)}},{key:"processOcrContent",value:function(e){var t="";e.data.ParsedResults.forEach(function(e){t+=e.ParsedText+"\n"}),this.setState({isPostingOcr:!1}),this.props.onOcrCompleted(this.state.lang,t),console.log(t)}},{key:"processOcrError",value:function(e){this.setState({isPostingOcr:!1}),console.log(e)}},{key:"handleReset",value:function(e){this.resetAll()}},{key:"handleCapturing",value:function(e){g(e.target.files[0],this.processBase64Image,this.processBase64ImageError)}},{key:"hangleLangBtnClick",value:function(e,t){document.getElementById("imgScanned").click(),this.setState({lang:e})}},{key:"render",value:function(){var e=this;return s.a.createElement(h.Page,{renderToolbar:function(){return s.a.createElement(h.Toolbar,null,s.a.createElement("div",{className:"center"},e.state.toolbar_msg),s.a.createElement("div",{className:"right"},s.a.createElement(h.ToolbarButton,{onClick:e.handleReset},s.a.createElement("i",{className:"zmdi zmdi-refresh"}))))}},s.a.createElement(h.Modal,{isOpen:this.state.isPostingOcr},s.a.createElement("p",null,"Loading ..."),s.a.createElement(h.ProgressCircular,{indeterminate:!0})),s.a.createElement("div",{className:"div-bgimg"},s.a.createElement("input",{type:"file",id:"imgScanned",name:"imgScanned",accept:"image/*",capture:"camera",style:{display:"none"},onChange:this.handleCapturing,onClick:function(e){e.target.value=null}}),this.state.scannedFileBase64&&s.a.createElement("img",{src:this.state.scannedFileBase64,alt:"Optical Character Recognition",height:"100%",onClick:function(t){e.setState({isPostingOcr:!0}),function(e,t,a,n,s){var o="https://api.ocr.space/parse/image",r=new FormData;r.append("apikey",e),r.append("base64Image",a),r.append("language",b(t)),console.log("POST to ["+o+"] started"),f.a.post(o,r).then(function(e){n(e)}).catch(function(e){s(e)}).then(function(){console.log("POST to ["+o+"] completed")})}("ff0751fd8988957",e.state.lang,e.state.scannedFileBase64,e.processOcrContent,e.processOcrError)}})),s.a.createElement(h.BottomToolbar,{modifier:"material"},s.a.createElement(h.Segment,{style:{width:"100%"},modifier:"material"},s.a.createElement(h.ToolbarButton,{onClick:function(t){e.hangleLangBtnClick(T,t)}},"\u5ee3\u6771\u8a71"),s.a.createElement(h.ToolbarButton,{onClick:function(t){e.hangleLangBtnClick(S,t)}},"\u666e\u901a\u8a9e\uff08\u7e41\uff09"),s.a.createElement(h.ToolbarButton,{onClick:function(t){e.hangleLangBtnClick(w,t)}},"English"))))}}]),t}(n.Component);function O(e,t,a,n,s,o){var r="https://api.voicerss.org/",c=new FormData;c.append("key",e),c.append("src",a),c.append("hl",E(t)),c.append("b64","true"),c.append("r",n),console.log("POST to ["+r+"] started"),f.a.post(r,c).then(function(e){s(e)}).catch(function(e){o(e)}).then(function(){console.log("POST to ["+r+"] completed")})}var E=function(e){return e||"en-US"},k="\u6309\u6b64\u64ad\u653e",C=50,j=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(i.a)(this,Object(d.a)(t).call(this,e))).props.ttsContent?a.state={toolbar_msg:k,ttsContents:a.props.ttsContent.trim().split(/\r?\n/),speechSpeed:C,isPostingTts:!1}:a.state={toolbar_msg:k,ttsContents:[],speechSpeed:C,isPostingTts:!1},a.handleReset=a.handleReset.bind(Object(u.a)(Object(u.a)(a))),a.handleBackHome=a.handleBackHome.bind(Object(u.a)(Object(u.a)(a))),a.handlePlay=a.handlePlay.bind(Object(u.a)(Object(u.a)(a))),a.handlePlayAll=a.handlePlayAll.bind(Object(u.a)(Object(u.a)(a))),a.handleUpdateItem=a.handleUpdateItem.bind(Object(u.a)(Object(u.a)(a))),a.handleMoveItem=a.handleMoveItem.bind(Object(u.a)(Object(u.a)(a))),a.processTtsContent=a.processTtsContent.bind(Object(u.a)(Object(u.a)(a))),a.processTtsError=a.processTtsError.bind(Object(u.a)(Object(u.a)(a))),a.playVoice=a.playVoice.bind(Object(u.a)(Object(u.a)(a))),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"resetAll",value:function(){this.props.ttsContent?this.setState({ttsContents:this.props.ttsContent.trim().split(/\r?\n/),speechSpeed:C,isPostingTts:!1}):this.setState({ttsContents:[],speechSpeed:C,isPostingTts:!1})}},{key:"handleBackHome",value:function(e){this.resetAll(),this.props.onBackToHome()}},{key:"handleReset",value:function(e){this.resetAll()}},{key:"handlePlay",value:function(e,t){this.state.isPostingTts?console.log("Posting to TTS in progress rejects a new coming request."):(this.setState({isPostingTts:!0}),O("679dc139ae34411489ad95b33225e6ed",this.props.lang,t,Math.floor(this.state.speechSpeed/5)-10,this.processTtsContent,this.processTtsError))}},{key:"handlePlayAll",value:function(e){this.playFromArray(this.state.ttsContents)}},{key:"playFromArray",value:function(e){var t,a=this,n="";if(void 0!==typeof e&&null!==e&&e.length>0)for(;e.length>0&&(t=n+"\n"+e[0],encodeURI(t).split(/%..|./).length-1<=9e4);)n+="\n"+e.shift();""!==n.trim()&&O("679dc139ae34411489ad95b33225e6ed",this.props.lang,n,Math.floor(this.state.speechSpeed/5)-10,function(t){if(void 0!==typeof t&&null!==t){var n=t.data;if(n.startsWith("ERROR"))console.log("Speech can't be played. Please try next time."),console.log(n);else a.playVoice(n)?a.playFromArray(e):console.log("Speech can't be played. Please try next time.")}else console.log("Speech can't be played. Please try next time.")},function(e){console.log(e)})}},{key:"handleUpdateItem",value:function(e,t){this.setState(function(a){return{ttsContents:a.ttsContents.map(function(a,n){return n===t?e.target.value:a})}})}},{key:"handleMoveItem",value:function(e,t,a){if(!(t+a<0||t+a>=this.state.ttsContents.length)){var n=this.state.ttsContents[t],s=this.state.ttsContents[t+a];this.setState(function(e){return{ttsContents:e.ttsContents.map(function(e,o){return o===t?s:o===t+a?n:e})}})}}},{key:"processTtsContent",value:function(e){if(void 0!==typeof e&&null!==e){var t=e.data;if(t.startsWith("ERROR"))console.log("Speech can't be played. Please try next time."),console.log(t);else this.playVoice(t)||console.log("Speech can't be played. Please try next time.")}else console.log("Speech can't be played. Please try next time.");this.setState({isPostingTts:!1})}},{key:"processTtsError",value:function(e){this.setState({isPostingTts:!1}),console.log(e)}},{key:"playVoice",value:function(e){var t=document.querySelector("#audioPlayback");if(!t.src||t.paused||t.ended){t.src=e,t.load();var a=t.play();return void 0!==a?a.then(function(){console.log("Automatic playback started!")}).catch(function(e){console.log(e)}):console.log("audio returns undefined."),a}return console.log("audio element is not available."),null}},{key:"render",value:function(){var e=this;return s.a.createElement(h.Page,{renderToolbar:function(){return s.a.createElement(h.Toolbar,null,s.a.createElement("div",{className:"left"},s.a.createElement(h.ToolbarButton,{onClick:e.handleBackHome},s.a.createElement("i",{className:"zmdi zmdi-home"}))),s.a.createElement("div",{className:"center",onClick:e.handlePlayAll},e.state.toolbar_msg,s.a.createElement("i",{className:"zmdi zmdi-play-circle"})),s.a.createElement("div",{className:"right"},s.a.createElement(h.ToolbarButton,{onClick:e.handleReset},s.a.createElement("i",{className:"zmdi zmdi-refresh"}))))}},s.a.createElement(h.Row,null,s.a.createElement(h.Col,{width:"20%",verticalAlign:"center",style:{textAlign:"right"}},s.a.createElement("i",{className:"zmdi zmdi-bike"}),"Slow"),s.a.createElement(h.Col,{width:"60^"},s.a.createElement(h.Range,{modifier:"material",style:{width:"100%"},value:this.state.speechSpeed,onChange:function(t){return e.setState({speechSpeed:parseInt(t.target.value)})}})),s.a.createElement(h.Col,{width:"20%",verticalAlign:"center",style:{textAlign:"left"}},s.a.createElement("i",{className:"zmdi zmdi-airplane"}),"Fast")),s.a.createElement(h.Row,null,s.a.createElement(h.Col,null,s.a.createElement("audio",{id:"audioPlayback",controls:!0,src:""}))),s.a.createElement(h.Row,null,s.a.createElement(h.Col,null,s.a.createElement(h.List,{dataSource:this.state.ttsContents,renderRow:function(t,a){return s.a.createElement(h.ListItem,{key:"contentItem-"+a,modifier:a===e.state.ttsContents.length-1?"longdivider":null},s.a.createElement("div",{className:"left",onClick:function(a){e.handlePlay(a,t)}},s.a.createElement("i",{className:"zmdi zmdi-play-circle",style:{fontSize:"1.5em"}})),s.a.createElement("div",{className:"center"},s.a.createElement(h.Input,{type:"text",modifier:"transparent",style:{width:"100%"},value:t,onChange:function(t){return e.handleUpdateItem(t,a)},float:!0})),s.a.createElement("div",{className:"right"},s.a.createElement("i",{className:"zmdi zmdi-caret-up-circle",style:{fontSize:"1.5em"},onClick:function(t){e.handleMoveItem(t,a,-1)}}),"\xa0",s.a.createElement("i",{className:"zmdi zmdi-caret-down-circle",style:{fontSize:"1.5em"},onClick:function(t){e.handleMoveItem(t,a,1)}})))}}))))}}]),t}(n.Component),P="",T="zh-hk",S="zh-tw",w="en-gb",B=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(i.a)(this,Object(d.a)(t).call(this,e))).state={lang:P,ttsContent:""},a.resetAll=a.resetAll.bind(Object(u.a)(Object(u.a)(a))),a.changeToTtsPage=a.changeToTtsPage.bind(Object(u.a)(Object(u.a)(a))),a.backToOcrPage=a.backToOcrPage.bind(Object(u.a)(Object(u.a)(a))),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"changeToTtsPage",value:function(e,t){this.setState({lang:e,ttsContent:t})}},{key:"backToOcrPage",value:function(){this.resetAll()}},{key:"resetAll",value:function(){this.setState({lang:P,ttsContent:""})}},{key:"render",value:function(){return s.a.createElement(h.Page,{id:"MainPage"},""===this.state.ttsContent&&s.a.createElement(v,{onOcrCompleted:this.changeToTtsPage}),this.state.ttsContent&&s.a.createElement(j,{lang:this.state.lang,ttsContent:this.state.ttsContent,onBackToHome:this.backToOcrPage}))}}]),t}(n.Component),I=function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement(B,null)}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(s.a.createElement(I,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[22,2,1]]]);
//# sourceMappingURL=main.9c9521f8.chunk.js.map